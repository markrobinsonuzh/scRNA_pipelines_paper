---
title: "Clustering"
author: "Pierre-Luc Germain"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    keep_md: true
---

```{r}
suppressPackageStartupMessages({
  library(ggplot2)
  library(cowplot)
  library(ComplexHeatmap)
  library
  library(pipeComp)
})
source("../misc_functions.R")
theme_set(theme_cowplot(font_size = 12))
```

```{r clustering, fig.width=12, fig.height=3}
res <- readRDS("../data/results_clust_2.rds")
h <- scrna_evalPlot_clust(res, what="MI", agg.by=c("norm","clustmethod"), scale=TRUE, anno_legend = FALSE)
h <- h + scrna_evalPlot_clust(res, what="mean_F1", agg.by=c("norm","clustmethod"), scale=TRUE, reorder_rows = h, anno_legend = FALSE) +
  scrna_evalPlot_clust(res, what="min_pr", agg.by=c("norm","clustmethod"), scale=TRUE, reorder_rows = h, anno_legend = FALSE) +
  scrna_evalPlot_clustAtTrueK(res, agg.by=c("norm","clustmethod"), reorder_rows = h, anno_legend = FALSE)
h <- .renameHrows(h, function(x) gsub("seurat; clustmethod=|; clustmethod=", "", gsub("seuratvst", "sctransform + ", x)))
h <- .renameHrows(h, function(x) gsub("clust.scran","scran (walktrap)",gsub("clust.scran.fg", "scran (fast_greedy)", x)))
h
```
